<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitacora de Lubricación</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>
    <div id="main-container">
        <h1>Registro de Mantenimiento - Bitácora de Lubricación</h1>

        <div id="form-container">
            <form action="/bitacora" method="POST">
                
                <div class="input-group">
                    <label for="equipo">Componente:</label>
                    <input type="text" id="equipo" name="equipo" placeholder="Ej: Compresor P-12 o Motor V8" required>
                </div>
                
                <div class="input-group">
                    <label for="tipo_lubricante">Tipo del Fluido:</label>
                    <input type="text" id="tipo_lubricante" name="tipo_lubricante" placeholder="Ej: Aceite ISO VG 46 (solo letras)" required class="input-solo-letras">
                </div>
                
                <div class="input-group">
                    <label for="fecha">Fecha del Cambio:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>
                
                <div class="input-group">
                    <label for="cantidad_utilizada">Cantidad Utilizada (Lts):</label>
                    <input type="number" step="0.01" id="cantidad_utilizada" name="cantidad_utilizada" placeholder="Use punto decimal (Ej: 250.75)" required>
                </div>
                
                <div class="input-group">
                    <label for="analisis">Muestra para Análisis:</label>
                    <select id="analisis" name="analisis" required>
                        <option value="1">Sí</option>
                        <option value="0" selected>No</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="resultados_analisis">Resultados del Análisis (Ref.):</label>
                    <input type="text" id="resultados_analisis" name="resultados_analisis" placeholder="Ej: OK-Baja Contaminación o Ref: LAB-2025-42">
                </div>
                
                <div class="input-group">
                    <label for="fecha_proxima">Próximo Cambio Estimado:</label>
                    <input type="date" id="fecha_proxima" name="fecha_proxima" placeholder="Formato: dd/mm/aaaa">
                </div>
                
                <div class="acciones-form">
                    <button type="submit">Guardar Registro</button>
                </div>
            </form>
        </div>
        
        <hr>

        <div id="bitacora-container">
            <h2>Bitácora de Lubricación</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>ID Equipo/Componente</th>
                        <th>Tipo de Fluido/Lubricante</th>
                        <th>Fecha de Cambio/Relleno</th>
                        <th>Cantidad Utilizada (Lts)</th>
                        <th>Muestra para Análisis</th>
                        <th>Resultados del Análisis (Ref.)</th>
                        <th>Próximo Cambio Estimado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <% bitacora.forEach(function(registro) { %>
                    <tr>
                        <td><%= registro.id %></td>
                        <td><%= registro.equipo %></td>
                        <td><%= registro.tipo_lubricante %></td>
                        <td><%= registro.fecha.toLocaleDateString('es-MX') %></td>
                        <td><%= registro.cantidad_utilizada %></td>
                        <td><%= registro.analisis ? 'Sí' : 'No' %></td>
                        <td><%= registro.resultados_analisis || '-' %></td>
                        <td><%= registro.fecha_proxima ? registro.fecha_proxima.toLocaleDateString('es-MX') : '-' %></td>
                        <td>
                            <a href="/bitacora/edit/<%= registro.id %>">Editar</a>
                            |
                            <a href="/bitacora/delete/<%= registro.id %>"
                                onclick="return confirm('¿Seguro que deseas eliminar el registro #<%= registro.id %>?');">
                                Eliminar
                            </a>
                        </td>
                    </tr>
                    <% }); %>
                    </tbody>
            </table>
        </div>
    </div>

    <footer>
        <button onclick="location.href='../index.html'">Regresar al index</button>
    </footer>

    <script src="/14 CRUDMYSQL/js/validaciones.js"></script>
</body>

</html>